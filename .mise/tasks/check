#!/usr/bin/env bash
#MISE description="Run typecheck, lint, and tests"
#MISE depends=["setup"]

set -euo pipefail

echo "ğŸ” Running checks..."
echo ""

echo "ğŸ”§ Environment:"
node -v
npm -v
pnpm -v
echo ""
echo "Vault Path: ${VAULT_PATH:-Not Set}"
echo ""

# TypeCheck
echo "ğŸ“ TypeCheck..."
tsc -noEmit
echo "âœ… TypeCheck passed"
echo ""

# Lint
echo "ğŸ¨ Linting..."
if [ -f ".eslintrc.json" ] || [ -f ".eslintrc.js" ] || [ -f ".eslintrc.yml" ]; then
  eslint src --ext .ts,.tsx
  echo "âœ… Linting passed"
else
  echo "âš ï¸  ESLint config not found, skipping"
fi
echo ""

# Tests
echo "ğŸ§ª Running tests..."
vitest run
echo "âœ… Tests passed"
echo ""

echo "âœ… All checks passed!"
